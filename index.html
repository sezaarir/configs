<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>کانفیگ‌های کانال تلگرام</title>
    <style>
        body {font-family: system-ui; background:#111; color:#eee; padding:20px; line-height:1.6;}
        h1 {color:#0f0; text-align:center;}
        ul {list-style:none; padding:0;}
        li {background:#222; margin:12px 0; padding:16px; border-radius:8px;}
        a {color:#0f8; text-decoration:none; word-break:break-all;}
        .time {color:#aaa; font-size:0.9em;}
    </style>
</head>
<body>
    <h1>کانفیگ‌های استخراج‌شده (آپدیت هر ساعت)</h1>
    <p id="status">در حال بارگذاری...</p>
    <ul id="list"></ul>

    <script>
        // لیست پروکسی‌های جدید و تست‌شده ۲۰۲۶ (یکی یکی امتحان می‌کنه)
        const proxies = [
            'https://corsproxy.io/?',               // اغلب خوب کار می‌کنه
            'https://api.allorigins.win/raw?url=',  // ساده و بدون محدودیت زیاد
            'https://proxy.cors.sh/',               // سریع، اما ممکنه نیاز به key داشته باشه (برای public رایگان)
            ''                                      // بدون پروکسی (آخرین تلاش مستقیم)
        ];

        const repoJson = 'https://raw.githubusercontent.com/sezaarir/configs/main/configs.json';  // اگر نام repo sezaair هست، عوض کن به sezaair

        async function tryFetch() {
            for (let proxy of proxies) {
                try {
                    let url = proxy ? proxy + encodeURIComponent(repoJson) : repoJson;
                    url += (url.includes('?') ? '&' : '?') + Date.now();  // جلوگیری از کش

                    const r = await fetch(url);
                    if (!r.ok) throw new Error(`Status ${r.status} با پروکسی ${proxy || 'مستقیم'}`);

                    const data = await r.json();
                    document.getElementById('status').textContent = `تعداد کانفیگ: ${data.length} (با پروکسی: ${proxy || 'مستقیم'})`;

                    const ul = document.getElementById('list');
                    ul.innerHTML = '';  // پاک کردن قبلی
                    data.forEach(item => {
                        const li = document.createElement('li');
                        const type = item.link.split('://')[0].toUpperCase();
                        li.innerHTML = `<strong>${type}</strong><br><a href="${item.link}">${item.desc || 'بدون توضیح'}</a>`;
                        ul.appendChild(li);
                    });
                    return;  // موفق شد، ادامه نده
                } catch (err) {
                    console.log('پروکسی شکست: ' + (proxy || 'مستقیم') + ' → ' + err);
                }
            }
            document.getElementById('status').textContent = 'همه پروکسی‌ها شکست خوردند – صفحه رو ذخیره کن و بعداً امتحان کن';
        }

        tryFetch();
    </script>
</body>
</html>
